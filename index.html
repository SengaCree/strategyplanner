<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarterly Business Planning Tool</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #f3e8ff 0%, #fce7f3 100%);
            min-height: 100vh;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .login-screen { display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .login-box { background: white; border-radius: 10px; padding: 40px; max-width: 400px; width: 100%; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .app-content { display: none; }
        .app-content.active { display: block; }
        .login-box h1 { color: #7c3aed; margin-bottom: 10px; }
        .login-box p { color: #666; margin-bottom: 30px; }
        .input-field { width: 100%; padding: 15px; border: 2px solid #e5e5e5; border-radius: 8px; font-size: 16px; margin-bottom: 20px; }
        .input-field:focus { outline: none; border-color: #7c3aed; }
        .btn-primary { background: linear-gradient(135deg, #7c3aed, #ec4899); color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; width: 100%; }
        .btn-primary:hover { opacity: 0.9; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #1f2937; font-size: 2.5rem; margin-bottom: 10px; }
        .header p { color: #666; font-size: 1.2rem; }
        .tabs { display: flex; justify-content: center; margin-bottom: 30px; background: white; border-radius: 10px; padding: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); flex-wrap: wrap; }
        .tab { padding: 15px 20px; border: none; background: none; cursor: pointer; border-radius: 8px; margin: 5px; font-size: 16px; color: #666; }
        .tab.active { background: linear-gradient(135deg, #7c3aed, #ec4899); color: white; }
        .tab:hover:not(.active) { background: #f3f4f6; }
        .content { background: white; border-radius: 10px; padding: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .info-box { padding: 20px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid; }
        .info-purple { background: #f3e8ff; border-left-color: #7c3aed; }
        .info-blue { background: #eff6ff; border-left-color: #3b82f6; }
        .info-green { background: #ecfdf5; border-left-color: #10b981; }
        .info-pink { background: #fdf2f8; border-left-color: #ec4899; }
        .offer-item { background: #f9fafb; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 2px solid #e5e7eb; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-weight: bold; margin-bottom: 5px; color: #374151; }
        .form-group input, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; }
        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: #7c3aed; }
        .form-group textarea { resize: vertical; min-height: 60px; }
        .revenue-display { background: linear-gradient(135deg, #ecfdf5, #eff6ff); padding: 30px; border-radius: 10px; text-align: center; border: 2px solid #10b981; margin-top: 20px; }
        .revenue-amount { font-size: 3rem; font-weight: bold; color: #10b981; margin-bottom: 10px; }
        .btn-add { background: linear-gradient(135deg, #7c3aed, #ec4899); color: white; border: none; padding: 12px 20px; border-radius: 6px; cursor: pointer; margin-bottom: 20px; }
        .btn-delete { background: #ef4444; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; }
        .btn-delete:hover { background: #dc2626; }
        .download-btn { background: #10b981; color: white; padding: 15px 20px; border: none; border-radius: 8px; cursor: pointer; margin: 5px; font-size: 16px; }
        .download-btn:hover { background: #059669; }
        .save-notice { background: #fef3c7; border: 1px solid #fbbf24; color: #92400e; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #e5e7eb; padding: 12px; text-align: left; }
        th { background: linear-gradient(135deg, #7c3aed, #ec4899); color: white; }
        tr:hover { background: #f9fafb; }
        .strategy-month { background: #f9fafb; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 2px solid #e5e7eb; }
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .tips-section { background: linear-gradient(135deg, #f3e8ff, #fdf2f8); padding: 20px; border-radius: 8px; margin-top: 30px; }
        .footer { text-align: center; margin-top: 30px; color: #666; }
        @media (max-width: 768px) {
            .form-row { grid-template-columns: 1fr; }
            .tabs { flex-direction: column; }
            .header h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <div style="font-size: 48px; margin-bottom: 20px;">üîí</div>
            <h1>Quarterly Planning Tool</h1>
            <p>Enter your password to access your strategic planning workspace</p>
            <input type="password" id="passwordInput" class="input-field" placeholder="Enter password">
            <button onclick="login()" class="btn-primary">Access Planning Tool</button>
        </div>
    </div>

    <!-- Main App -->
    <div id="appContent" class="app-content">
        <div class="container">
            <div class="save-notice">
                <strong>üí° Important:</strong> Your work is not automatically saved. Use the "Download Plan" button to save your progress!
            </div>
            
            <div class="header">
                <h1>Quarterly Business Planning Tool</h1>
                <p>Strategic clarity for accelerated growth</p>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="showTab('capacity')">üìä Capacity Planner</button>
                <button class="tab" onclick="showTab('launches')">üéØ Monthly Launches</button>
                <button class="tab" onclick="showTab('strategy')">üìÖ 90-Day Strategy</button>
                <button class="tab" onclick="showTab('weekly')">‚è∞ Weekly Structure</button>
                <button class="tab" onclick="showDownloadOptions()" style="background: #10b981; color: white;">üíæ Download</button>
            </div>

            <!-- Download Options Modal -->
            <div id="downloadModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 10px; max-width: 500px; width: 90%;">
                    <h3 style="margin-top: 0; color: #1f2937;">Choose Your Download Format</h3>
                    <div style="margin: 20px 0;">
                        <button onclick="downloadPDF()" class="btn-primary" style="margin: 10px 0; background: #dc2626;">üìÑ Professional PDF Report</button>
                        <button onclick="downloadWordDoc()" class="btn-primary" style="margin: 10px 0; background: #2563eb;">üìù Word Document</button>
                        <button onclick="downloadSimpleText()" class="btn-primary" style="margin: 10px 0; background: #059669;">üìã Simple Text Plan</button>
                        <button onclick="downloadSpreadsheet()" class="btn-primary" style="margin: 10px 0; background: #7c3aed;">üìä Excel-style CSV</button>
                    </div>
                    <button onclick="closeDownloadModal()" style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; float: right;">Close</button>
                </div>
            </div>

            <div class="content">
                <!-- Capacity Planner Tab -->
                <div id="capacity" class="tab-content active">
                    <h2>Capacity Planner</h2>
                    <div class="info-box info-purple">
                        <h3>Purpose & Guidance</h3>
                        <p>This tool helps you gain crystal clarity on your offer ecosystem and revenue potential. By mapping out each offer with its pricing and frequency, you'll create a realistic annual revenue projection that becomes your north star for strategic planning.</p>
                        <p><strong>Pro Tip:</strong> Include all revenue streams - courses, coaching, memberships, workshops, affiliate income, etc.</p>
                        <p><strong>Frequency Guide:</strong> How many times per year will you launch/sell this offer? (Monthly = 12, Quarterly = 4, etc.)</p>
                    </div>

                    <div id="offersContainer">
                        <div class="offer-item">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Offer Name</label>
                                    <input type="text" placeholder="e.g., 1:1 Coaching" onchange="calculateRevenue()">
                                </div>
                                <div class="form-group">
                                    <label>Price (¬£)</label>
                                    <input type="number" placeholder="0" onchange="calculateRevenue()">
                                </div>
                                <div class="form-group">
                                    <label>Frequency/Year</label>
                                    <input type="number" value="1" onchange="calculateRevenue()">
                                </div>
                                <div class="form-group">
                                    <label>Annual Revenue</label>
                                    <div style="font-size: 20px; font-weight: bold; color: #10b981; padding: 10px;">¬£0</div>
                                </div>
                                <div>
                                    <button class="btn-delete" onclick="removeOffer(this)" style="display: none;">üóëÔ∏è</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="btn-add" onclick="addOffer()">‚ûï Add Another Offer</button>

                    <div class="revenue-display">
                        <h3>Annual Revenue Projection</h3>
                        <div class="revenue-amount" id="totalRevenue">¬£0</div>
                        <p>This is your revenue goal based on your current offer structure.</p>
                    </div>
                </div>

                <!-- Monthly Launches Tab -->
                <div id="launches" class="tab-content">
                    <h2>Monthly Launch Strategy</h2>
                    <div class="info-box info-blue">
                        <h3>Strategic Layering & Multiple Income Streams</h3>
                        <p>This monthly view helps you strategically layer your offers throughout the year, creating multiple touchpoints with your audience and diversified revenue streams. Think seasonality, energy cycles, and market timing.</p>
                        <p><strong>Layering Strategy:</strong> Combine high-ticket with low-ticket offers, passive with active income</p>
                        <p><strong>Energy Management:</strong> Balance intensive launches with nurturing/content months</p>
                        <p><strong>Market Timing:</strong> Consider industry cycles, holidays, and your audience's buying patterns</p>
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th>Month</th>
                                <th>Primary Offer</th>
                                <th>Secondary Offer</th>
                                <th>Passive/Ongoing</th>
                                <th>Strategy Notes</th>
                            </tr>
                        </thead>
                        <tbody id="monthlyTable">
                            <!-- Months will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <!-- 90-Day Strategy Tab -->
                <div id="strategy" class="tab-content">
                    <h2>90-Day Strategic Focus</h2>
                    <div class="info-box info-green">
                        <h3>Clarity, Focus & Acceleration</h3>
                        <p>This 90-day planning framework eliminates scattered energy and amplifies your speed by creating laser focus on what matters most each month. By defining clear goals across all business functions, you'll move from reactive to proactive leadership.</p>
                        <p><strong>Financial Goals:</strong> Specific revenue targets, profit margins, key metrics</p>
                        <p><strong>Delivery:</strong> Client/customer fulfillment, service delivery, product completion</p>
                        <p><strong>Creating:</strong> Content, products, systems, processes being developed</p>
                        <p><strong>Selling:</strong> Marketing campaigns, sales activities, conversion optimization</p>
                        <p><strong>Audience Growth:</strong> Lead generation, community building, brand awareness strategies</p>
                    </div>

                    <div id="strategyContainer">
                        <!-- Strategy months will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Weekly Structure Tab -->
                <div id="weekly" class="tab-content">
                    <h2>Weekly Structure Design</h2>
                    <div class="info-box info-pink">
                        <h3>Design Your Ideal Week</h3>
                        <p>Create a weekly structure that honors your energy, priorities, and life design. This isn't about rigid scheduling‚Äîit's about creating intentional rhythms that support your highest performance and wellbeing.</p>
                        <p><strong>Key Work Blocks:</strong> Delivery time, CEO/finance time, content creation, team collaboration</p>
                        <p><strong>Energy Management:</strong> Match high-energy tasks to your peak hours</p>
                        <p><strong>Life Integration:</strong> Include rest, play, family time, and personal growth</p>
                        <p><strong>Flexibility:</strong> Leave white space for spontaneity and unexpected opportunities</p>
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>Morning Focus</th>
                                <th>Afternoon/Evening Focus</th>
                            </tr>
                        </thead>
                        <tbody id="weeklyTable">
                            <!-- Days will be populated by JavaScript -->
                        </tbody>
                    </table>

                    <div class="tips-section">
                        <h3>Weekly Structure Tips</h3>
                        <div class="grid-2">
                            <div>
                                <p><strong>Essential Work Blocks:</strong></p>
                                <ul>
                                    <li>Client delivery time</li>
                                    <li>CEO/strategy time</li>
                                    <li>Content creation</li>
                                    <li>Sales & marketing</li>
                                    <li>Team meetings</li>
                                </ul>
                            </div>
                            <div>
                                <p><strong>Life Integration:</strong></p>
                                <ul>
                                    <li>Rest and recovery</li>
                                    <li>Exercise and movement</li>
                                    <li>Family and relationships</li>
                                    <li>Personal growth</li>
                                    <li>Creative play</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer">
                <p>¬© Senga Cree Coaching - Strategic Business Planning Tool</p>
            </div>
        </div>
    </div>

    <script>
        // Login functionality
        function login() {
            const password = document.getElementById('passwordInput').value;
            if (password === 'strategy2025') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('appContent').style.display = 'block';
                initializeApp();
            } else {
                alert('Incorrect password. Please try again.');
            }
        }

        // Allow Enter key to login
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') login();
        });

        // Tab functionality
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Capacity Planner functionality
        function addOffer() {
            const container = document.getElementById('offersContainer');
            const newOffer = document.createElement('div');
            newOffer.className = 'offer-item';
            newOffer.innerHTML = `
                <div class="form-row">
                    <div class="form-group">
                        <label>Offer Name</label>
                        <input type="text" placeholder="e.g., 1:1 Coaching" onchange="calculateRevenue()">
                    </div>
                    <div class="form-group">
                        <label>Price (¬£)</label>
                        <input type="number" placeholder="0" onchange="calculateRevenue()">
                    </div>
                    <div class="form-group">
                        <label>Frequency/Year</label>
                        <input type="number" value="1" onchange="calculateRevenue()">
                    </div>
                    <div class="form-group">
                        <label>Annual Revenue</label>
                        <div style="font-size: 20px; font-weight: bold; color: #10b981; padding: 10px;">¬£0</div>
                    </div>
                    <div>
                        <button class="btn-delete" onclick="removeOffer(this)">üóëÔ∏è</button>
                    </div>
                </div>
            `;
            container.appendChild(newOffer);
            updateDeleteButtons();
        }

        // Download functionality
        function showDownloadOptions() {
            document.getElementById('downloadModal').style.display = 'block';
        }

        function closeDownloadModal() {
            document.getElementById('downloadModal').style.display = 'none';
        }

        function collectAllData() {
            const data = {
                timestamp: new Date().toLocaleDateString('en-GB'),
                offers: [],
                monthlyPlans: [],
                strategy: [],
                weeklyStructure: []
            };

            // Collect offers data
            const offers = document.querySelectorAll('.offer-item');
            offers.forEach(offer => {
                const inputs = offer.querySelectorAll('input');
                if (inputs.length >= 3) {
                    data.offers.push({
                        name: inputs[0].value || 'Unnamed Offer',
                        price: inputs[1].value || '0',
                        frequency: inputs[2].value || '0',
                        revenue: (parseFloat(inputs[1].value) || 0) * (parseInt(inputs[2].value) || 0)
                    });
                }
            });

            // Collect monthly plans data
            const monthlyRows = document.querySelectorAll('#monthlyTable tr');
            monthlyRows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 5) {
                    data.monthlyPlans.push({
                        month: cells[0].textContent,
                        primaryOffer: cells[1].querySelector('input').value || '',
                        secondaryOffer: cells[2].querySelector('input').value || '',
                        passiveOffer: cells[3].querySelector('input').value || '',
                        notes: cells[4].querySelector('textarea').value || ''
                    });
                }
            });

            // Collect strategy data
            const strategyMonths = document.querySelectorAll('.strategy-month');
            strategyMonths.forEach((month, index) => {
                const textareas = month.querySelectorAll('textarea');
                data.strategy.push({
                    month: `Month ${index + 1}`,
                    financial: textareas[0].value || '',
                    delivery: textareas[1].value || '',
                    creating: textareas[2].value || '',
                    selling: textareas[3].value || '',
                    audience: textareas[4].value || ''
                });
            });

            // Collect weekly structure data
            const weeklyRows = document.querySelectorAll('#weeklyTable tr');
            weeklyRows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 3) {
                    data.weeklyStructure.push({
                        day: cells[0].textContent,
                        morning: cells[1].querySelector('textarea').value || '',
                        afternoon: cells[2].querySelector('textarea').value || ''
                    });
                }
            });

            return data;
        }

        function downloadPDF() {
            const data = collectAllData();
            const totalRevenue = data.offers.reduce((sum, offer) => sum + offer.revenue, 0);
            
            let content = `<!DOCTYPE html>
<html><head>
<title>Quarterly Business Plan</title>
<style>
body { font-family: Arial, sans-serif; line-height: 1.6; margin: 40px; color: #333; }
.header { text-align: center; border-bottom: 3px solid #7c3aed; padding-bottom: 20px; margin-bottom: 30px; }
.section { margin-bottom: 40px; page-break-inside: avoid; }
.section-title { background: #7c3aed; color: white; padding: 15px; margin: 20px 0 10px 0; font-size: 18px; font-weight: bold; }
.offer-box { background: #f8fafc; border-left: 4px solid #10b981; padding: 15px; margin: 10px 0; }
.revenue-highlight { background: #dcfce7; border: 2px solid #10b981; padding: 20px; text-align: center; margin: 20px 0; }
.month-row { background: #f9fafb; padding: 10px; margin: 5px 0; border-left: 3px solid #ec4899; }
.strategy-box { background: #f0f9ff; padding: 15px; margin: 10px 0; border-radius: 8px; }
.day-schedule { background: #fdf2f8; padding: 10px; margin: 5px 0; border-radius: 5px; }
table { width: 100%; border-collapse: collapse; margin: 15px 0; }
th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
th { background: #7c3aed; color: white; }
.footer { text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; }
@media print { body { margin: 20px; } .section { page-break-inside: avoid; } }
</style>
</head><body>

<div class="header">
<h1>QUARTERLY BUSINESS PLAN</h1>
<p>Strategic Planning Document | Generated: ${data.timestamp}</p>
</div>

<div class="section">
<div class="section-title">üìä CAPACITY PLANNER & REVENUE PROJECTION</div>`;

            data.offers.forEach((offer, index) => {
                content += `
<div class="offer-box">
<strong>${offer.name}</strong><br>
Price: ¬£${offer.price} | Frequency: ${offer.frequency} times/year<br>
<strong>Annual Revenue: ¬£${offer.revenue.toLocaleString()}</strong>
</div>`;
            });

            content += `
<div class="revenue-highlight">
<h2>TOTAL ANNUAL REVENUE PROJECTION</h2>
<h1 style="color: #10b981; margin: 10px 0;">¬£${totalRevenue.toLocaleString()}</h1>
</div>
</div>

<div class="section">
<div class="section-title">üéØ MONTHLY LAUNCH STRATEGY</div>`;

            data.monthlyPlans.forEach(plan => {
                if (plan.primaryOffer || plan.secondaryOffer || plan.passiveOffer || plan.notes) {
                    content += `
<div class="month-row">
<strong>${plan.month}</strong><br>
Primary: ${plan.primaryOffer}<br>
Secondary: ${plan.secondaryOffer}<br>
Passive: ${plan.passiveOffer}<br>
Notes: ${plan.notes}
</div>`;
                }
            });

            content += `
</div>

<div class="section">
<div class="section-title">üìÖ 90-DAY STRATEGIC FOCUS</div>`;

            data.strategy.forEach(month => {
                if (month.financial || month.delivery || month.creating || month.selling || month.audience) {
                    content += `
<div class="strategy-box">
<h3>${month.month}</h3>
<p><strong>Financial Goal:</strong> ${month.financial}</p>
<p><strong>Delivery Focus:</strong> ${month.delivery}</p>
<p><strong>Creating Priority:</strong> ${month.creating}</p>
<p><strong>Selling Strategy:</strong> ${month.selling}</p>
<p><strong>Audience Growth:</strong> ${month.audience}</p>
</div>`;
                }
            });

            content += `
</div>

<div class="section">
<div class="section-title">‚è∞ WEEKLY STRUCTURE DESIGN</div>`;

            data.weeklyStructure.forEach(day => {
                if (day.morning || day.afternoon) {
                    content += `
<div class="day-schedule">
<strong>${day.day}</strong><br>
Morning: ${day.morning}<br>
Afternoon/Evening: ${day.afternoon}
</div>`;
                }
            });

            content += `
</div>

<div class="footer">
<p>¬© Senga Cree Coaching - Strategic Business Planning Tool</p>
<p>This document contains your personalized quarterly business strategy</p>
</div>

</body></html>`;

            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Quarterly-Business-Plan-${data.timestamp.replace(/\//g, '-')}.html`;
            a.click();
            URL.revokeObjectURL(url);
            closeDownloadModal();
        }

        function downloadWordDoc() {
            const data = collectAllData();
            const totalRevenue = data.offers.reduce((sum, offer) => sum + offer.revenue, 0);
            
            let content = `QUARTERLY BUSINESS PLAN
Strategic Planning Document
Generated: ${data.timestamp}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìä CAPACITY PLANNER & REVENUE PROJECTION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

OFFERS OVERVIEW:
`;

            data.offers.forEach((offer, index) => {
                content += `
${index + 1}. ${offer.name}
   Price: ¬£${offer.price}
   Frequency: ${offer.frequency} times per year
   Annual Revenue: ¬£${offer.revenue.toLocaleString()}
`;
            });

            content += `
üí∞ TOTAL ANNUAL REVENUE PROJECTION: ¬£${totalRevenue.toLocaleString()}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üéØ MONTHLY LAUNCH STRATEGY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
`;

            data.monthlyPlans.forEach(plan => {
                if (plan.primaryOffer || plan.secondaryOffer || plan.passiveOffer || plan.notes) {
                    content += `
${plan.month}:
‚îú‚îÄ Primary Offer: ${plan.primaryOffer}
‚îú‚îÄ Secondary Offer: ${plan.secondaryOffer}
‚îú‚îÄ Passive/Ongoing: ${plan.passiveOffer}
‚îî‚îÄ Strategy Notes: ${plan.notes}
`;
                }
            });

            content += `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìÖ 90-DAY STRATEGIC FOCUS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
`;

            data.strategy.forEach(month => {
                if (month.financial || month.delivery || month.creating || month.selling || month.audience) {
                    content += `
${month.month}:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üí∞ Financial Goal: ${month.financial}
üì¶ Delivery Focus: ${month.delivery}
üî® Creating Priority: ${month.creating}
üíº Selling Strategy: ${month.selling}
üìà Audience Growth: ${month.audience}

`;
                }
            });

            content += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚è∞ WEEKLY STRUCTURE DESIGN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
`;

            data.weeklyStructure.forEach(day => {
                if (day.morning || day.afternoon) {
                    content += `
${day.day}:
üåÖ Morning Focus: ${day.morning}
üåá Afternoon/Evening Focus: ${day.afternoon}
`;
                }
            });

            content += `
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
¬© Senga Cree Coaching - Strategic Business Planning Tool
This document contains your personalized quarterly business strategy
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;

            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Quarterly-Business-Plan-${data.timestamp.replace(/\//g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            closeDownloadModal();
        }

        function downloadSimpleText() {
            const data = collectAllData();
            const totalRevenue = data.offers.reduce((sum, offer) => sum + offer.revenue, 0);
            
            let content = `MY QUARTERLY BUSINESS PLAN
Created: ${data.timestamp}

REVENUE GOAL: ¬£${totalRevenue.toLocaleString()}

MY OFFERS:
`;

            data.offers.forEach(offer => {
                content += `‚Ä¢ ${offer.name} - ¬£${offer.price} x ${offer.frequency} = ¬£${offer.revenue.toLocaleString()}\n`;
            });

            content += `\nMONTHLY LAUNCH PLAN:\n`;
            data.monthlyPlans.forEach(plan => {
                if (plan.primaryOffer || plan.secondaryOffer || plan.passiveOffer) {
                    content += `${plan.month}: ${plan.primaryOffer}${plan.secondaryOffer ? ', ' + plan.secondaryOffer : ''}${plan.passiveOffer ? ', ' + plan.passiveOffer : ''}\n`;
                }
            });

            content += `\n90-DAY STRATEGY:\n`;
            data.strategy.forEach(month => {
                if (month.financial || month.delivery || month.creating || month.selling || month.audience) {
                    content += `${month.month}: Financial: ${month.financial}, Delivery: ${month.delivery}, Creating: ${month.creating}\n`;
                }
            });

            content += `\nWEEKLY STRUCTURE:\n`;
            data.weeklyStructure.forEach(day => {
                if (day.morning || day.afternoon) {
                    content += `${day.day}: Morning: ${day.morning}, Afternoon: ${day.afternoon}\n`;
                }
            });

            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `My-Business-Plan-${data.timestamp.replace(/\//g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            closeDownloadModal();
        }

        function downloadSpreadsheet() {
            const data = collectAllData();
            
            let csv = `Quarterly Business Plan,Generated: ${data.timestamp}\n\n`;
            
            csv += `OFFERS & REVENUE\n`;
            csv += `Offer Name,Price (¬£),Frequency,Annual Revenue (¬£)\n`;
            data.offers.forEach(offer => {
                csv += `"${offer.name}",${offer.price},${offer.frequency},${offer.revenue}\n`;
            });
            
            const totalRevenue = data.offers.reduce((sum, offer) => sum + offer.revenue, 0);
            csv += `TOTAL,,,${totalRevenue}\n\n`;
            
            csv += `MONTHLY LAUNCHES\n`;
            csv += `Month,Primary Offer,Secondary Offer,Passive Offer,Notes\n`;
            data.monthlyPlans.forEach(plan => {
                csv += `${plan.month},"${plan.primaryOffer}","${plan.secondaryOffer}","${plan.passiveOffer}","${plan.notes}"\n`;
            });
            
            csv += `\n90-DAY STRATEGY\n`;
            csv += `Month,Financial Goal,Delivery Focus,Creating Priority,Selling Strategy,Audience Growth\n`;
            data.strategy.forEach(month => {
                csv += `${month.month},"${month.financial}","${month.delivery}","${month.creating}","${month.selling}","${month.audience}"\n`;
            });
            
            csv += `\nWEEKLY STRUCTURE\n`;
            csv += `Day,Morning Focus,Afternoon Focus\n`;
            data.weeklyStructure.forEach(day => {
                csv += `${day.day},"${day.morning}","${day.afternoon}"\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Business-Plan-Spreadsheet-${data.timestamp.replace(/\//g, '-')}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            closeDownloadModal();
        }

        function removeOffer(button) {
            button.closest('.offer-item').remove();
            calculateRevenue();
            updateDeleteButtons();
        }

        function updateDeleteButtons() {
            const offers = document.querySelectorAll('.offer-item');
            offers.forEach((offer, index) => {
                const deleteBtn = offer.querySelector('.btn-delete');
                if (offers.length > 1) {
                    deleteBtn.style.display = 'block';
                } else {
                    deleteBtn.style.display = 'none';
                }
            });
        }

        function calculateRevenue() {
            const offers = document.querySelectorAll('.offer-item');
            let total = 0;
            
            offers.forEach(offer => {
                const inputs = offer.querySelectorAll('input');
                const price = parseFloat(inputs[1].value) || 0;
                const frequency = parseInt(inputs[2].value) || 0;
                const revenue = price * frequency;
                
                const revenueDisplay = offer.querySelector('.form-row > div:nth-child(4) > div');
                revenueDisplay.textContent = '¬£' + revenue.toLocaleString();
                
                total += revenue;
            });
            
            document.getElementById('totalRevenue').textContent = '¬£' + total.toLocaleString();
        }

        // Initialize app
        function initializeApp() {
            // Initialize monthly launches table
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                           'July', 'August', 'September', 'October', 'November', 'December'];
            const monthlyTable = document.getElementById('monthlyTable');
            
            months.forEach(month => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="font-weight: bold; color: #7c3aed;">${month}</td>
                    <td><input type="text" class="form-control" placeholder="Main launch/focus"></td>
                    <td><input type="text" class="form-control" placeholder="Supporting offer"></td>
                    <td><input type="text" class="form-control" placeholder="Passive income"></td>
                    <td><textarea class="form-control" placeholder="Energy level, seasonality, market timing..." rows="2"></textarea></td>
                `;
                monthlyTable.appendChild(row);
            });

            // Initialize strategy sections
            const strategyContainer = document.getElementById('strategyContainer');
            for (let i = 1; i <= 3; i++) {
                const monthDiv = document.createElement('div');
                monthDiv.className = 'strategy-month';
                monthDiv.innerHTML = `
                    <h3 style="color: #7c3aed; margin-bottom: 20px;">Month ${i}</h3>
                    <div class="grid-3">
                        <div class="form-group">
                            <label>Financial Goal</label>
                            <textarea placeholder="Revenue target, profit goals, key metrics..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Delivery Focus</label>
                            <textarea placeholder="Client work, fulfillment, service delivery..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Creating Priority</label>
                            <textarea placeholder="Content, products, systems to build..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Selling Strategy</label>
                            <textarea placeholder="Marketing, sales activities, conversions..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Audience Growth</label>
                            <textarea placeholder="Lead gen, community building, brand awareness..." rows="3"></textarea>
                        </div>
                    </div>
                `;
                strategyContainer.appendChild(monthDiv);
            }

            // Initialize weekly structure table
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            const weeklyTable = document.getElementById('weeklyTable');
            
            days.forEach(day => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="font-weight: bold; color: #7c3aed;">${day}</td>
                    <td><textarea class="form-control" placeholder="Morning activities, energy focus..." rows="2"></textarea></td>
                    <td><textarea class="form-control" placeholder="Afternoon/evening activities..." rows="2"></textarea></td>
                `;
                weeklyTable.appendChild(row);
            });

            updateDeleteButtons();
        }

        // Add CSS for form controls in tables
        const style = document.createElement('style');
        style.textContent = `
            .form-control {
                width: 100%;
                padding: 8px;
                border: 1px solid #d1d5db;
                border-radius: 4px;
                font-size: 14px;
            }
            .form-control:focus {
                outline: none;
                border-color: #7c3aed;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
